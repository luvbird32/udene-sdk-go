import { useVulnerabilityScans } from "./hooks/useVulnerabilityScans";
import { VulnerabilityScanList } from "./components/VulnerabilityScanList";
import { VulnerabilityScanHeader } from "./components/VulnerabilityScanHeader";
import { ReportQuickActions } from "../reporting/components/ReportQuickActions";
import { ScanActions } from "./components/vulnerability-scan/ScanActions";

export const VulnerabilityScanning = () => {
  const { data: scans, isLoading, refetch } = useVulnerabilityScans();
  const { startNewScan } = ScanActions({ onScanComplete: refetch });
  const isScanning = scans?.some(scan => scan.status === 'in_progress');

  return (
    <div className="space-y-4">
      <VulnerabilityScanHeader onStartScan={startNewScan} />
      <ReportQuickActions onStartScan={startNewScan} isScanning={isScanning} />
      <VulnerabilityScanList scans={scans} isLoading={isLoading} />
    </div>
  );
};