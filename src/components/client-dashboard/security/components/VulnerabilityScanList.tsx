import { Card } from "@/components/ui/card";
import { Loader2 } from "lucide-react";
import { VulnerabilityScanItem } from "./VulnerabilityScanItem";

interface SeverityBreakdown {
  critical: number;
  high: number;
  medium: number;
  low: number;
}

interface VulnerabilityScan {
  id: string;
  scan_type: string;
  status: string;
  start_time: string;
  end_time: string | null;
  total_vulnerabilities: number;
  severity_breakdown: SeverityBreakdown;
}

interface VulnerabilityScanListProps {
  scans?: VulnerabilityScan[];
  isLoading: boolean;
}

export const VulnerabilityScanList = ({ scans, isLoading }: VulnerabilityScanListProps) => {
  if (isLoading) {
    return (
      <Card className="p-6 flex justify-center items-center">
        <Loader2 className="h-6 w-6 animate-spin" />
      </Card>
    );
  }

  if (!scans || scans.length === 0) {
    return (
      <Card className="p-6 text-center text-muted-foreground">
        No vulnerability scans found. Start a new scan to check your application security.
      </Card>
    );
  }

  return (
    <div className="space-y-4">
      {scans.map((scan) => (
        <VulnerabilityScanItem key={scan.id} scan={scan} />
      ))}
    </div>
  );
};